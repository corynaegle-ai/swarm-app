# Swarm Verifier - Deployment Manifest

service:
  name: swarm-verifier
  description: "Code verification and validation service"
  pm2_name: swarm-verifier
  port: 8090
  
repository:
  path: /opt/swarm-verifier
  github: corynaegle-ai/swarm-verifier
  branch: main
  
environment:
  target: dev
  droplet_ip: 134.199.235.140
  
build:
  pre_checks:
    - test -f package.json
    - test -f server.js
  commands:
    - npm ci
  timeout: 120
  working_dir: /opt/swarm-verifier
  
deploy:
  strategy: replace
  commands:
    - pm2 restart swarm-verifier --update-env
  timeout: 60
  
health_check:
  endpoint: http://localhost:8090/health
  method: GET
  expected_status: 200
  timeout: 30
  retries: 3
  retry_delay: 5
  
rollback:
  enabled: true
  strategy: git_revert
  commands:
    - git stash
    - git checkout HEAD^
    - npm ci
    - pm2 restart swarm-verifier --update-env
    
dependencies:
  services: []
  env_vars:
    - ANTHROPIC_API_KEY
    
notifications:
  on_success: true
  on_failure: true
  create_ticket: true
